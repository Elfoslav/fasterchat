<template name="home">
  <div class="row">
    <div class="col-sm-12">
      {{#if loggingIn}}
        <div class="page-header">
          <h1>Logging in <small>please wait...</small></h1>
        </div>
      {{else}}
        <div class="page-header">
          <h1>Livechat <small>realtime chat</small></h1>
        </div>
      {{/if}}

      {{#unless loggingIn}}
        {{#unless currentUser}}
          <button class="btn btn-primary fb-login">Login with Facebook</button>
        {{/unless}}
      {{/unless}}

      {{#if currentUser}}
        <div class="list-group">
          {{#each getUserFriends}}
            <a href="/chat/{{id}}" class="list-group-item">
              <img src="https://graph.facebook.com/{{id}}/picture?type=small" alt="photo" />
              {{name}}

              {{#if isOnline id}}
                <span class="dot dot-online" title="online"></span>
              {{else}}
                <span class="dot dot-offline" title="offline"></span>
              {{/if}}

              &nbsp;<span class="glyphicon glyphicon-comment typing-now hidden" title="typing now"></span>

              {{#if getUnreadMessagesCount id}}
                <span class="label label-info">{{getUnreadMessagesCount id}}</span>
              {{/if}}
            </a>
          {{else}}
            <p>
              No one of your friends use Livechat.
              <a href="https://www.facebook.com/sharer/sharer.php?u={{url}}&display=popup" target="_blank">Share Livechat with friends!</a></p>
          {{/each}}
        </div>
      {{/if}}
    </div>
  </div>
</template>